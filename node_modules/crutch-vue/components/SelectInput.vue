<template>
    <div :class="groupClass">
        <label class="form-label" :class="labelClass" :for="selectId">{{ label }}</label>
        <select :id="selectId" class="form-select" :class="selectClass" v-model="activeOption" :disabled="disable">
            <option v-for="(obj, index) in options" :key="index" :value="obj.value">
                {{ obj.friendlyVal }}
            </option>
        </select>
        <div class="invalid-feedback" :class="errorClass" v-show="showErrorText" v-if="useErrorFeedback">
            {{ errorText }}
        </div>
    </div>
</template>

<script lang="ts">
    import { defineComponent, computed, PropType } from 'vue';

    const SelectInput = defineComponent({
        name: 'SelectInput',
        props: {
            options: { type: Object as PropType<SelectInputData>, default: [] },
            modelValue: { type: [Object, Array, String, Number], default: null },
            disable: { type: Boolean, default: false },
            selectClass: { type: [String, Object, Array], default: '' },
            label: { type: String, default: 'Set label attribute!' },
            labelClass: { type: String, default: '' },
            groupClass: { type: String, default: '' },
            selectId: { type: String, default: 'SelectInput' },
            errorClass: { type: String, default: '' },
            showErrorText: { type: Boolean, default: false },
            errorText: { type: String, default: 'Set HelperText!' },
            useErrorFeedback: { type: Boolean, default: true },
        },
        setup(props, { emit }) {
            const activeOption = computed({
                get: () => props.modelValue,
                set: (value) => emit('update:modelValue', value)
            });

            return {
                activeOption,
            }
        }
    });

    type SelectInputData = [
        {
            friendlyVal: string,
            value: number
        }
    ]

    export default SelectInput
    export {
        SelectInput
    }
</script>